(async()=>{for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));var r=Object.defineProperty,a=Object.defineProperties,i=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(e,t,a)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,da=(e,t)=>{for(var a in t=t||{})n.call(t,a)&&s(e,a,t[a]);if(o)for(var a of o(t))l.call(t,a)&&s(e,a,t[a]);return e},ca=(e,t)=>a(e,i(t)),d="spicedl_config",c={apiPort:5985,apiHost:"127.0.0.1",language:void 0};function h(){var e=u();return`http://${e.apiHost}:`+e.apiPort}function u(){try{var e,t=Spicetify.LocalStorage.get(d);if(t)return e=JSON.parse(t),da(da({},c),e)}catch(e){console.error("Error loading config:",e)}return da({},c)}function p(e){try{var t=u(),a=da(da({},t),e);Spicetify.LocalStorage.set(d,JSON.stringify(a))}catch(e){throw console.error("Error saving config:",e),e}}async function g(e){try{var t,a=await fetch(h()+"/download",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})});if(a.ok)return await a.json();throw t=await a.json(),new Error(t.error||"HTTP error! status: "+a.status)}catch(e){throw console.error("Error starting download:",e),e}}async function S(){try{return(await fetch(h()+"/health")).ok}catch(e){return!1}}var t=class{constructor(){this.currentLanguage="en",this.translations=new Map,this.localeDir="locales",this.loadLanguage("en")}setLanguage(e){e!==this.currentLanguage&&(this.currentLanguage=e,this.loadLanguage(e))}getLanguage(){return this.currentLanguage}detectLanguage(){try{let e=null;if(null!=Spicetify&&Spicetify.Locale)try{var t;(e=!(e="function"==typeof Spicetify.Locale.getLocale?Spicetify.Locale.getLocale():e)&&Spicetify.Locale._locale?Spicetify.Locale._locale:e)||"function"!=typeof Spicetify.Locale.getUrlLocale||(t=Spicetify.Locale.getUrlLocale())&&(e=t)}catch(e){console.warn("Error getting locale from Spicetify.Locale:",e)}if(e){if(e.toLowerCase().startsWith("zh"))return e.includes("TW")||e.includes("HK")||e.includes("MO")||e.includes("Hant")?"zh-TW":"zh-CN";var a=e.split("-")[0].toLowerCase();if(this.hasLanguage(a))return a}var r=navigator.language||navigator.userLanguage;if(r){if(r.toLowerCase().startsWith("zh"))return r.includes("TW")||r.includes("HK")||r.includes("MO")||r.includes("Hant")?"zh-TW":"zh-CN";var i=r.split("-")[0].toLowerCase();if(this.hasLanguage(i))return i}}catch(e){console.warn("Error detecting language:",e)}return"en"}hasLanguage(e){return["en","ja","es","it","fr","ru","zh","zh-CN","zh_CN","zh-TW","zh_TW"].includes(e)}loadLanguage(t){try{var e=localStorage.getItem("spicedl_i18n_"+t);if(e)try{var a=JSON.parse(e);return void this.translations.set(t,a)}catch(e){console.warn(`Failed to parse stored translations for ${t}:`,e)}"en"===t?this.translations.set(t,this.getDefaultEnglishTranslations()):"ja"===t?this.translations.set(t,this.getDefaultJapaneseTranslations()):"es"===t?this.translations.set(t,this.getDefaultSpanishTranslations()):"it"===t?this.translations.set(t,this.getDefaultItalianTranslations()):"fr"===t?this.translations.set(t,this.getDefaultFrenchTranslations()):"ru"===t?this.translations.set(t,this.getDefaultRussianTranslations()):"zh-CN"===t||"zh_CN"===t||"zh"===t?(this.translations.set("zh-CN",this.getDefaultSimplifiedChineseTranslations()),this.currentLanguage="zh-CN"):"zh-TW"===t||"zh_TW"===t?(this.translations.set("zh-TW",this.getDefaultTraditionalChineseTranslations()),this.currentLanguage="zh-TW"):(console.warn(`Language "${t}" is not supported, falling back to English`),this.translations.set("en",this.getDefaultEnglishTranslations()),this.currentLanguage="en")}catch(e){console.error(`Error loading language ${t}:`,e),"en"!==t&&(this.loadLanguage("en"),this.currentLanguage="en")}}getDefaultEnglishTranslations(){return{ui:{title:"Download Status",downloads:"{count} downloads",openFolder:"ðŸ“ Open Download Folder",refresh:"âŸ³ Refresh",total:"Total",active:"Active",completed:"Completed",failed:"Failed",cancelled:"Cancelled",all:"All",noDownloads:"No downloads",noDownloadsFilter:"No downloads match this filter",startDownloading:"Right-click on tracks or albums to start downloading",loading:"Loading...",error:"Error",retry:"Retry",cancel:"âŠ˜ Cancel",started:"Started:",completedTime:"Completed:",errorDetails:"Error Details",starting:"Starting",downloading:"Downloading",completedStatus:"Completed",failedStatus:"Failed",cancelledStatus:"Cancelled"},menu:{downloadTrack:"Download with SpiceDL",downloadAlbum:"Download Album with SpiceDL",downloadPlaylist:"Download Playlist with SpiceDL",downloadStatus:"Download Status",settings:"SpiceDL Settings"},notifications:{apiUnavailable:"Cannot connect to SpiceDL API server. Please check if the server is running.",invalidUri:"Invalid URI",downloadStarted:"Download started: {id}",albumDownloadStarted:"Album download started: {id}",playlistDownloadStarted:"Playlist download started: {id}",downloadCancelled:"Download cancelled",downloadFailed:"Failed to start download",cancelFailed:"Failed to cancel",folderOpened:"Download folder opened",openFolderFailed:"Failed to open folder",settingsSaved:"Settings saved",settingsReset:"Settings reset",apiSettingsOpened:"API server settings window opened",apiSettingsFailed:"Failed to open API server settings window"},settings:{title:"SpiceDL Extension Settings",apiHost:"API Server Host",apiPort:"API Server Port",save:"Save",reset:"Reset",portRange:"Port number must be between 1 and 65535",hostRequired:"Please enter a host name",saveFailed:"Failed to save settings",apiServerSettings:"API Server Settings",apiServerSettingsDesc:"To change API server settings such as download folder and port, click the button below.",openApiServerSettings:"Open API Server Settings"}}}getDefaultJapaneseTranslations(){return{ui:{title:"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹",downloads:"{count} ä»¶ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",openFolder:"ðŸ“ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ«ãƒ€ã‚’é–‹ã",refresh:"âŸ³ æ›´æ–°",total:"åˆè¨ˆ",active:"ã‚¢ã‚¯ãƒ†ã‚£ãƒ–",completed:"å®Œäº†",failed:"å¤±æ•—",cancelled:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«",all:"ã™ã¹ã¦",noDownloads:"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãªã—",noDownloadsFilter:"ã“ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã«ä¸€è‡´ã™ã‚‹ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒã‚ã‚Šã¾ã›ã‚“",startDownloading:"ãƒˆãƒ©ãƒƒã‚¯ã‚„ã‚¢ãƒ«ãƒãƒ ã‚’å³ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹",loading:"èª­ã¿è¾¼ã¿ä¸­...",error:"ã‚¨ãƒ©ãƒ¼",retry:"å†è©¦è¡Œ",cancel:"âŠ˜ ã‚­ãƒ£ãƒ³ã‚»ãƒ«",started:"é–‹å§‹:",completedTime:"å®Œäº†:",errorDetails:"ã‚¨ãƒ©ãƒ¼è©³ç´°",starting:"é–‹å§‹ä¸­",downloading:"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­",completedStatus:"å®Œäº†",failedStatus:"å¤±æ•—",cancelledStatus:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"},menu:{downloadTrack:"SpiceDLã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",downloadAlbum:"SpiceDLã§ã‚¢ãƒ«ãƒãƒ ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",downloadPlaylist:"SpiceDLã§ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",downloadStatus:"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹",settings:"SpiceDLè¨­å®š"},notifications:{apiUnavailable:"SpiceDL APIã‚µãƒ¼ãƒãƒ¼ã«æŽ¥ç¶šã§ãã¾ã›ã‚“ã€‚ã‚µãƒ¼ãƒãƒ¼ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚",invalidUri:"ç„¡åŠ¹ãªURI",downloadStarted:"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¾ã—ãŸ: {id}",albumDownloadStarted:"ã‚¢ãƒ«ãƒãƒ ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¾ã—ãŸ: {id}",playlistDownloadStarted:"ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¾ã—ãŸ: {id}",downloadCancelled:"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸ",downloadFailed:"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã®é–‹å§‹ã«å¤±æ•—ã—ã¾ã—ãŸ",cancelFailed:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã«å¤±æ•—ã—ã¾ã—ãŸ",folderOpened:"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ«ãƒ€ã‚’é–‹ãã¾ã—ãŸ",openFolderFailed:"ãƒ•ã‚©ãƒ«ãƒ€ã‚’é–‹ã‘ã¾ã›ã‚“ã§ã—ãŸ",settingsSaved:"è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ",settingsReset:"è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ",apiSettingsOpened:"APIã‚µãƒ¼ãƒãƒ¼è¨­å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‹ãã¾ã—ãŸ",apiSettingsFailed:"APIã‚µãƒ¼ãƒãƒ¼è¨­å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‹ã‘ã¾ã›ã‚“ã§ã—ãŸ"},settings:{title:"SpiceDLæ‹¡å¼µæ©Ÿèƒ½è¨­å®š",apiHost:"APIã‚µãƒ¼ãƒãƒ¼ãƒ›ã‚¹ãƒˆ",apiPort:"APIã‚µãƒ¼ãƒãƒ¼ãƒãƒ¼ãƒˆ",save:"ä¿å­˜",reset:"ãƒªã‚»ãƒƒãƒˆ",portRange:"ãƒãƒ¼ãƒˆç•ªå·ã¯1ã‹ã‚‰65535ã®é–“ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™",hostRequired:"ãƒ›ã‚¹ãƒˆåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„",saveFailed:"è¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ",apiServerSettings:"APIã‚µãƒ¼ãƒãƒ¼è¨­å®š",apiServerSettingsDesc:"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ«ãƒ€ã‚„ãƒãƒ¼ãƒˆãªã©ã®APIã‚µãƒ¼ãƒãƒ¼è¨­å®šã‚’å¤‰æ›´ã™ã‚‹ã«ã¯ã€ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚",openApiServerSettings:"APIã‚µãƒ¼ãƒãƒ¼è¨­å®šã‚’é–‹ã"}}}getDefaultSpanishTranslations(){return{ui:{title:"Estado de Descarga",downloads:"{count} descargas",openFolder:"ðŸ“ Abrir Carpeta de Descarga",refresh:"âŸ³ Actualizar",total:"Total",active:"Activo",completed:"Completado",failed:"Fallido",cancelled:"Cancelado",all:"Todos",noDownloads:"Sin descargas",noDownloadsFilter:"No hay descargas que coincidan con este filtro",startDownloading:"Haga clic derecho en pistas o Ã¡lbumes para comenzar a descargar",loading:"Cargando...",error:"Error",retry:"Reintentar",cancel:"âŠ˜ Cancelar",started:"Iniciado:",completedTime:"Completado:",errorDetails:"Detalles del Error",starting:"Iniciando",downloading:"Descargando",completedStatus:"Completado",failedStatus:"Fallido",cancelledStatus:"Cancelado"},menu:{downloadTrack:"Descargar con SpiceDL",downloadAlbum:"Descargar Ãlbum con SpiceDL",downloadPlaylist:"Descargar Lista de ReproducciÃ³n con SpiceDL",downloadStatus:"Estado de Descarga",settings:"ConfiguraciÃ³n de SpiceDL"},notifications:{apiUnavailable:"No se puede conectar al servidor API de SpiceDL. Por favor, verifique si el servidor estÃ¡ en ejecuciÃ³n.",invalidUri:"URI invÃ¡lido",downloadStarted:"Descarga iniciada: {id}",albumDownloadStarted:"Descarga de Ã¡lbum iniciada: {id}",playlistDownloadStarted:"Descarga de lista de reproducciÃ³n iniciada: {id}",downloadCancelled:"Descarga cancelada",downloadFailed:"Error al iniciar la descarga",cancelFailed:"Error al cancelar",folderOpened:"Carpeta de descarga abierta",openFolderFailed:"Error al abrir la carpeta",settingsSaved:"ConfiguraciÃ³n guardada",settingsReset:"ConfiguraciÃ³n restablecida",apiSettingsOpened:"Ventana de configuraciÃ³n del servidor API abierta",apiSettingsFailed:"Error al abrir la ventana de configuraciÃ³n del servidor API"},settings:{title:"ConfiguraciÃ³n de ExtensiÃ³n SpiceDL",apiHost:"Host del Servidor API",apiPort:"Puerto del Servidor API",save:"Guardar",reset:"Restablecer",portRange:"El nÃºmero de puerto debe estar entre 1 y 65535",hostRequired:"Por favor, ingrese un nombre de host",saveFailed:"Error al guardar la configuraciÃ³n",apiServerSettings:"ConfiguraciÃ³n del Servidor API",apiServerSettingsDesc:"Para cambiar la configuraciÃ³n del servidor API como la carpeta de descarga y el puerto, haga clic en el botÃ³n de abajo.",openApiServerSettings:"Abrir ConfiguraciÃ³n del Servidor API"}}}getDefaultItalianTranslations(){return{ui:{title:"Stato Download",downloads:"{count} download",openFolder:"ðŸ“ Apri Cartella Download",refresh:"âŸ³ Aggiorna",total:"Totale",active:"Attivo",completed:"Completato",failed:"Fallito",cancelled:"Annullato",all:"Tutti",noDownloads:"Nessun download",noDownloadsFilter:"Nessun download corrisponde a questo filtro",startDownloading:"Fare clic destro su tracce o album per iniziare il download",loading:"Caricamento...",error:"Errore",retry:"Riprova",cancel:"âŠ˜ Annulla",started:"Iniziato:",completedTime:"Completato:",errorDetails:"Dettagli Errore",starting:"Iniziando",downloading:"Scaricando",completedStatus:"Completato",failedStatus:"Fallito",cancelledStatus:"Annullato"},menu:{downloadTrack:"Scarica con SpiceDL",downloadAlbum:"Scarica Album con SpiceDL",downloadPlaylist:"Scarica Playlist con SpiceDL",downloadStatus:"Stato Download",settings:"Impostazioni SpiceDL"},notifications:{apiUnavailable:"Impossibile connettersi al server API SpiceDL. Verificare se il server Ã¨ in esecuzione.",invalidUri:"URI non valido",downloadStarted:"Download avviato: {id}",albumDownloadStarted:"Download album avviato: {id}",playlistDownloadStarted:"Download playlist avviato: {id}",downloadCancelled:"Download annullato",downloadFailed:"Impossibile avviare il download",cancelFailed:"Impossibile annullare",folderOpened:"Cartella download aperta",openFolderFailed:"Impossibile aprire la cartella",settingsSaved:"Impostazioni salvate",settingsReset:"Impostazioni reimpostate",apiSettingsOpened:"Finestra impostazioni server API aperta",apiSettingsFailed:"Impossibile aprire la finestra impostazioni server API"},settings:{title:"Impostazioni Estensione SpiceDL",apiHost:"Host Server API",apiPort:"Porta Server API",save:"Salva",reset:"Reimposta",portRange:"Il numero di porta deve essere compreso tra 1 e 65535",hostRequired:"Inserire un nome host",saveFailed:"Impossibile salvare le impostazioni",apiServerSettings:"Impostazioni Server API",apiServerSettingsDesc:"Per modificare le impostazioni del server API come la cartella di download e la porta, fare clic sul pulsante sottostante.",openApiServerSettings:"Apri Impostazioni Server API"}}}getDefaultFrenchTranslations(){return{ui:{title:"Ã‰tat du TÃ©lÃ©chargement",downloads:"{count} tÃ©lÃ©chargements",openFolder:"ðŸ“ Ouvrir le Dossier de TÃ©lÃ©chargement",refresh:"âŸ³ Actualiser",total:"Total",active:"Actif",completed:"TerminÃ©",failed:"Ã‰chouÃ©",cancelled:"AnnulÃ©",all:"Tous",noDownloads:"Aucun tÃ©lÃ©chargement",noDownloadsFilter:"Aucun tÃ©lÃ©chargement ne correspond Ã  ce filtre",startDownloading:"Clic droit sur les pistes ou albums pour commencer le tÃ©lÃ©chargement",loading:"Chargement...",error:"Erreur",retry:"RÃ©essayer",cancel:"âŠ˜ Annuler",started:"DÃ©marrÃ© :",completedTime:"TerminÃ© :",errorDetails:"DÃ©tails de l'Erreur",starting:"DÃ©marrage",downloading:"TÃ©lÃ©chargement",completedStatus:"TerminÃ©",failedStatus:"Ã‰chouÃ©",cancelledStatus:"AnnulÃ©"},menu:{downloadTrack:"TÃ©lÃ©charger avec SpiceDL",downloadAlbum:"TÃ©lÃ©charger l'Album avec SpiceDL",downloadPlaylist:"TÃ©lÃ©charger la Playlist avec SpiceDL",downloadStatus:"Ã‰tat du TÃ©lÃ©chargement",settings:"ParamÃ¨tres SpiceDL"},notifications:{apiUnavailable:"Impossible de se connecter au serveur API SpiceDL. Veuillez vÃ©rifier si le serveur est en cours d'exÃ©cution.",invalidUri:"URI invalide",downloadStarted:"TÃ©lÃ©chargement dÃ©marrÃ© : {id}",albumDownloadStarted:"TÃ©lÃ©chargement d'album dÃ©marrÃ© : {id}",playlistDownloadStarted:"TÃ©lÃ©chargement de playlist dÃ©marrÃ© : {id}",downloadCancelled:"TÃ©lÃ©chargement annulÃ©",downloadFailed:"Ã‰chec du dÃ©marrage du tÃ©lÃ©chargement",cancelFailed:"Ã‰chec de l'annulation",folderOpened:"Dossier de tÃ©lÃ©chargement ouvert",openFolderFailed:"Ã‰chec de l'ouverture du dossier",settingsSaved:"ParamÃ¨tres enregistrÃ©s",settingsReset:"ParamÃ¨tres rÃ©initialisÃ©s",apiSettingsOpened:"FenÃªtre des paramÃ¨tres du serveur API ouverte",apiSettingsFailed:"Ã‰chec de l'ouverture de la fenÃªtre des paramÃ¨tres du serveur API"},settings:{title:"ParamÃ¨tres de l'Extension SpiceDL",apiHost:"HÃ´te du Serveur API",apiPort:"Port du Serveur API",save:"Enregistrer",reset:"RÃ©initialiser",portRange:"Le numÃ©ro de port doit Ãªtre entre 1 et 65535",hostRequired:"Veuillez entrer un nom d'hÃ´te",saveFailed:"Ã‰chec de l'enregistrement des paramÃ¨tres",apiServerSettings:"ParamÃ¨tres du Serveur API",apiServerSettingsDesc:"Pour modifier les paramÃ¨tres du serveur API tels que le dossier de tÃ©lÃ©chargement et le port, cliquez sur le bouton ci-dessous.",openApiServerSettings:"Ouvrir les ParamÃ¨tres du Serveur API"}}}getDefaultRussianTranslations(){return{ui:{title:"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸",downloads:"{count} Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¾Ðº",openFolder:"ðŸ“ ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ ÐŸÐ°Ð¿ÐºÑƒ Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸",refresh:"âŸ³ ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ",total:"Ð’ÑÐµÐ³Ð¾",active:"ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ",completed:"Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾",failed:"ÐžÑˆÐ¸Ð±ÐºÐ°",cancelled:"ÐžÑ‚Ð¼ÐµÐ½ÐµÐ½Ð¾",all:"Ð’ÑÐµ",noDownloads:"ÐÐµÑ‚ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¾Ðº",noDownloadsFilter:"ÐÐµÑ‚ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¾Ðº, ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… ÑÑ‚Ð¾Ð¼Ñƒ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñƒ",startDownloading:"Ð©ÐµÐ»ÐºÐ½Ð¸Ñ‚Ðµ Ð¿Ñ€Ð°Ð²Ð¾Ð¹ ÐºÐ½Ð¾Ð¿ÐºÐ¾Ð¹ Ð¼Ñ‹ÑˆÐ¸ Ð½Ð° Ñ‚Ñ€ÐµÐºÐ°Ñ… Ð¸Ð»Ð¸ Ð°Ð»ÑŒÐ±Ð¾Ð¼Ð°Ñ…, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ð°Ñ‡Ð°Ñ‚ÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÑƒ",loading:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°...",error:"ÐžÑˆÐ¸Ð±ÐºÐ°",retry:"ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ",cancel:"âŠ˜ ÐžÑ‚Ð¼ÐµÐ½Ð°",started:"ÐÐ°Ñ‡Ð°Ñ‚Ð¾:",completedTime:"Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾:",errorDetails:"Ð”ÐµÑ‚Ð°Ð»Ð¸ ÐžÑˆÐ¸Ð±ÐºÐ¸",starting:"Ð—Ð°Ð¿ÑƒÑÐº",downloading:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°",completedStatus:"Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾",failedStatus:"ÐžÑˆÐ¸Ð±ÐºÐ°",cancelledStatus:"ÐžÑ‚Ð¼ÐµÐ½ÐµÐ½Ð¾"},menu:{downloadTrack:"Ð¡ÐºÐ°Ñ‡Ð°Ñ‚ÑŒ Ñ SpiceDL",downloadAlbum:"Ð¡ÐºÐ°Ñ‡Ð°Ñ‚ÑŒ ÐÐ»ÑŒÐ±Ð¾Ð¼ Ñ SpiceDL",downloadPlaylist:"Ð¡ÐºÐ°Ñ‡Ð°Ñ‚ÑŒ ÐŸÐ»ÐµÐ¹Ð»Ð¸ÑÑ‚ Ñ SpiceDL",downloadStatus:"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸",settings:"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ SpiceDL"},notifications:{apiUnavailable:"ÐÐµ ÑƒÐ´Ð°ÐµÑ‚ÑÑ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒÑÑ Ðº ÑÐµÑ€Ð²ÐµÑ€Ñƒ API SpiceDL. ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ, Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð»Ð¸ ÑÐµÑ€Ð²ÐµÑ€.",invalidUri:"ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ URI",downloadStarted:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð½Ð°Ñ‡Ð°Ñ‚Ð°: {id}",albumDownloadStarted:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð°Ð»ÑŒÐ±Ð¾Ð¼Ð° Ð½Ð°Ñ‡Ð°Ñ‚Ð°: {id}",playlistDownloadStarted:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¿Ð»ÐµÐ¹Ð»Ð¸ÑÑ‚Ð° Ð½Ð°Ñ‡Ð°Ñ‚Ð°: {id}",downloadCancelled:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½Ð°",downloadFailed:"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð½Ð°Ñ‡Ð°Ñ‚ÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÑƒ",cancelFailed:"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¾Ñ‚Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ",folderOpened:"ÐŸÐ°Ð¿ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð°",openFolderFailed:"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð¿Ð°Ð¿ÐºÑƒ",settingsSaved:"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ñ‹",settingsReset:"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ÑÐ±Ñ€Ð¾ÑˆÐµÐ½Ñ‹",apiSettingsOpened:"ÐžÐºÐ½Ð¾ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº ÑÐµÑ€Ð²ÐµÑ€Ð° API Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¾",apiSettingsFailed:"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð¾ÐºÐ½Ð¾ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº ÑÐµÑ€Ð²ÐµÑ€Ð° API"},settings:{title:"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ñ SpiceDL",apiHost:"Ð¥Ð¾ÑÑ‚ Ð¡ÐµÑ€Ð²ÐµÑ€Ð° API",apiPort:"ÐŸÐ¾Ñ€Ñ‚ Ð¡ÐµÑ€Ð²ÐµÑ€Ð° API",save:"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ",reset:"Ð¡Ð±Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ",portRange:"ÐÐ¾Ð¼ÐµÑ€ Ð¿Ð¾Ñ€Ñ‚Ð° Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð±Ñ‹Ñ‚ÑŒ Ð¾Ñ‚ 1 Ð´Ð¾ 65535",hostRequired:"ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð²Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¸Ð¼Ñ Ñ…Ð¾ÑÑ‚Ð°",saveFailed:"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐ¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸",apiServerSettings:"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð¡ÐµÑ€Ð²ÐµÑ€Ð° API",apiServerSettingsDesc:"Ð§Ñ‚Ð¾Ð±Ñ‹ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ÑÐµÑ€Ð²ÐµÑ€Ð° API, Ñ‚Ð°ÐºÐ¸Ðµ ÐºÐ°Ðº Ð¿Ð°Ð¿ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¸ Ð¿Ð¾Ñ€Ñ‚, Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ ÐºÐ½Ð¾Ð¿ÐºÑƒ Ð½Ð¸Ð¶Ðµ.",openApiServerSettings:"ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð¡ÐµÑ€Ð²ÐµÑ€Ð° API"}}}getDefaultSimplifiedChineseTranslations(){return{ui:{title:"ä¸‹è½½çŠ¶æ€",downloads:"{count} ä¸ªä¸‹è½½",openFolder:"ðŸ“ æ‰“å¼€ä¸‹è½½æ–‡ä»¶å¤¹",refresh:"âŸ³ åˆ·æ–°",total:"æ€»è®¡",active:"æ´»åŠ¨",completed:"å·²å®Œæˆ",failed:"å¤±è´¥",cancelled:"å·²å–æ¶ˆ",all:"å…¨éƒ¨",noDownloads:"æ²¡æœ‰ä¸‹è½½",noDownloadsFilter:"æ²¡æœ‰åŒ¹é…æ­¤ç­›é€‰å™¨çš„ä¸‹è½½",startDownloading:"å³é”®å•å‡»æ›²ç›®æˆ–ä¸“è¾‘ä»¥å¼€å§‹ä¸‹è½½",loading:"åŠ è½½ä¸­...",error:"é”™è¯¯",retry:"é‡è¯•",cancel:"âŠ˜ å–æ¶ˆ",started:"å·²å¼€å§‹ï¼š",completedTime:"å·²å®Œæˆï¼š",errorDetails:"é”™è¯¯è¯¦æƒ…",starting:"å¯åŠ¨ä¸­",downloading:"ä¸‹è½½ä¸­",completedStatus:"å·²å®Œæˆ",failedStatus:"å¤±è´¥",cancelledStatus:"å·²å–æ¶ˆ"},menu:{downloadTrack:"ä½¿ç”¨ SpiceDL ä¸‹è½½",downloadAlbum:"ä½¿ç”¨ SpiceDL ä¸‹è½½ä¸“è¾‘",downloadPlaylist:"ä½¿ç”¨ SpiceDL ä¸‹è½½æ’­æ”¾åˆ—è¡¨",downloadStatus:"ä¸‹è½½çŠ¶æ€",settings:"SpiceDL è®¾ç½®"},notifications:{apiUnavailable:"æ— æ³•è¿žæŽ¥åˆ° SpiceDL API æœåŠ¡å™¨ã€‚è¯·æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦æ­£åœ¨è¿è¡Œã€‚",invalidUri:"æ— æ•ˆçš„ URI",downloadStarted:"ä¸‹è½½å·²å¼€å§‹ï¼š{id}",albumDownloadStarted:"ä¸“è¾‘ä¸‹è½½å·²å¼€å§‹ï¼š{id}",playlistDownloadStarted:"æ’­æ”¾åˆ—è¡¨ä¸‹è½½å·²å¼€å§‹ï¼š{id}",downloadCancelled:"ä¸‹è½½å·²å–æ¶ˆ",downloadFailed:"å¯åŠ¨ä¸‹è½½å¤±è´¥",cancelFailed:"å–æ¶ˆå¤±è´¥",folderOpened:"ä¸‹è½½æ–‡ä»¶å¤¹å·²æ‰“å¼€",openFolderFailed:"æ‰“å¼€æ–‡ä»¶å¤¹å¤±è´¥",settingsSaved:"è®¾ç½®å·²ä¿å­˜",settingsReset:"è®¾ç½®å·²é‡ç½®",apiSettingsOpened:"API æœåŠ¡å™¨è®¾ç½®çª—å£å·²æ‰“å¼€",apiSettingsFailed:"æ‰“å¼€ API æœåŠ¡å™¨è®¾ç½®çª—å£å¤±è´¥"},settings:{title:"SpiceDL æ‰©å±•è®¾ç½®",apiHost:"API æœåŠ¡å™¨ä¸»æœº",apiPort:"API æœåŠ¡å™¨ç«¯å£",save:"ä¿å­˜",reset:"é‡ç½®",portRange:"ç«¯å£å·å¿…é¡»åœ¨ 1 åˆ° 65535 ä¹‹é—´",hostRequired:"è¯·è¾“å…¥ä¸»æœºå",saveFailed:"ä¿å­˜è®¾ç½®å¤±è´¥",apiServerSettings:"API æœåŠ¡å™¨è®¾ç½®",apiServerSettingsDesc:"è¦æ›´æ”¹ API æœåŠ¡å™¨è®¾ç½®ï¼ˆå¦‚ä¸‹è½½æ–‡ä»¶å¤¹å’Œç«¯å£ï¼‰ï¼Œè¯·å•å‡»ä¸‹é¢çš„æŒ‰é’®ã€‚",openApiServerSettings:"æ‰“å¼€ API æœåŠ¡å™¨è®¾ç½®"}}}getDefaultTraditionalChineseTranslations(){return{ui:{title:"ä¸‹è¼‰ç‹€æ…‹",downloads:"{count} å€‹ä¸‹è¼‰",openFolder:"ðŸ“ é–‹å•Ÿä¸‹è¼‰è³‡æ–™å¤¾",refresh:"âŸ³ é‡æ–°æ•´ç†",total:"ç¸½è¨ˆ",active:"æ´»å‹•",completed:"å·²å®Œæˆ",failed:"å¤±æ•—",cancelled:"å·²å–æ¶ˆ",all:"å…¨éƒ¨",noDownloads:"æ²’æœ‰ä¸‹è¼‰",noDownloadsFilter:"æ²’æœ‰ç¬¦åˆæ­¤ç¯©é¸å™¨çš„ä¸‹è¼‰",startDownloading:"å³éµå–®æ“Šæ›²ç›®æˆ–å°ˆè¼¯ä»¥é–‹å§‹ä¸‹è¼‰",loading:"è¼‰å…¥ä¸­...",error:"éŒ¯èª¤",retry:"é‡è©¦",cancel:"âŠ˜ å–æ¶ˆ",started:"å·²é–‹å§‹ï¼š",completedTime:"å·²å®Œæˆï¼š",errorDetails:"éŒ¯èª¤è©³æƒ…",starting:"å•Ÿå‹•ä¸­",downloading:"ä¸‹è¼‰ä¸­",completedStatus:"å·²å®Œæˆ",failedStatus:"å¤±æ•—",cancelledStatus:"å·²å–æ¶ˆ"},menu:{downloadTrack:"ä½¿ç”¨ SpiceDL ä¸‹è¼‰",downloadAlbum:"ä½¿ç”¨ SpiceDL ä¸‹è¼‰å°ˆè¼¯",downloadPlaylist:"ä½¿ç”¨ SpiceDL ä¸‹è¼‰æ’­æ”¾æ¸…å–®",downloadStatus:"ä¸‹è¼‰ç‹€æ…‹",settings:"SpiceDL è¨­å®š"},notifications:{apiUnavailable:"ç„¡æ³•é€£æŽ¥åˆ° SpiceDL API ä¼ºæœå™¨ã€‚è«‹æª¢æŸ¥ä¼ºæœå™¨æ˜¯å¦æ­£åœ¨åŸ·è¡Œã€‚",invalidUri:"ç„¡æ•ˆçš„ URI",downloadStarted:"ä¸‹è¼‰å·²é–‹å§‹ï¼š{id}",albumDownloadStarted:"å°ˆè¼¯ä¸‹è¼‰å·²é–‹å§‹ï¼š{id}",playlistDownloadStarted:"æ’­æ”¾æ¸…å–®ä¸‹è¼‰å·²é–‹å§‹ï¼š{id}",downloadCancelled:"ä¸‹è¼‰å·²å–æ¶ˆ",downloadFailed:"å•Ÿå‹•ä¸‹è¼‰å¤±æ•—",cancelFailed:"å–æ¶ˆå¤±æ•—",folderOpened:"ä¸‹è¼‰è³‡æ–™å¤¾å·²é–‹å•Ÿ",openFolderFailed:"é–‹å•Ÿè³‡æ–™å¤¾å¤±æ•—",settingsSaved:"è¨­å®šå·²å„²å­˜",settingsReset:"è¨­å®šå·²é‡è¨­",apiSettingsOpened:"API ä¼ºæœå™¨è¨­å®šè¦–çª—å·²é–‹å•Ÿ",apiSettingsFailed:"é–‹å•Ÿ API ä¼ºæœå™¨è¨­å®šè¦–çª—å¤±æ•—"},settings:{title:"SpiceDL æ“´å……åŠŸèƒ½è¨­å®š",apiHost:"API ä¼ºæœå™¨ä¸»æ©Ÿ",apiPort:"API ä¼ºæœå™¨é€£æŽ¥åŸ ",save:"å„²å­˜",reset:"é‡è¨­",portRange:"é€£æŽ¥åŸ è™Ÿå¿…é ˆåœ¨ 1 åˆ° 65535 ä¹‹é–“",hostRequired:"è«‹è¼¸å…¥ä¸»æ©Ÿåç¨±",saveFailed:"å„²å­˜è¨­å®šå¤±æ•—",apiServerSettings:"API ä¼ºæœå™¨è¨­å®š",apiServerSettingsDesc:"è¦è®Šæ›´ API ä¼ºæœå™¨è¨­å®šï¼ˆå¦‚ä¸‹è¼‰è³‡æ–™å¤¾å’Œé€£æŽ¥åŸ ï¼‰ï¼Œè«‹æŒ‰ä¸€ä¸‹ä¸‹é¢çš„æŒ‰éˆ•ã€‚",openApiServerSettings:"é–‹å•Ÿ API ä¼ºæœå™¨è¨­å®š"}}}t(e,a){var t;let r=this.translations.get(this.currentLanguage)||{};for(t of e.split(".")){if(!(r&&"object"==typeof r&&t in r)){if("en"!==this.currentLanguage){var i,o=this.translations.get("en")||{};r=o;for(i of e.split(".")){if(!(r&&"object"==typeof r&&i in r)){r=null;break}r=r[i]}}else r=null;break}r=r[t]}return null===r||"string"!=typeof r?e:a?r.replace(/\{(\w+)\}/g,(e,t)=>void 0!==a[t]?String(a[t]):e):r}},v=null;function m(){var e;return v||(e=(v=new t).detectLanguage(),v.setLanguage(e)),v}function b(e,t){return m().t(e,t)}var x=Spicetify.React,{useState:D,useEffect:A,useRef:E,useCallback:k}=x,f=()=>{let[e,o]=D([]),[n,ra]=D({}),ia=E({}),oa=E(new Set),[,na]=D(new Set),[t,l]=D(!0),[a,s]=D(null),[,d]=D(!1),[r,i]=D("all"),c=E({}),la=E(!0),u=E(null),p=E(new Set),g=E(null),v=E(null),sa=e=>{try{var t=e.match(/spotify\.com\/(track|album|playlist|artist)\/([a-zA-Z0-9]+)/);if(t)return`spotify:${t[1]}:`+t[2]}catch(e){console.error("Error converting URL to URI:",e)}return null},m=k(async()=>{if(la.current){var e=S();p.current.add(e);try{var t=await e;if(p.current.delete(e),la.current){if(d(t),!t)return la.current?(s(b("notifications.apiUnavailable")),void l(!1)):void 0;var a,r=(async e=>{try{var t,a=h(),r=e?a+"/status?id="+encodeURIComponent(e):a+"/status",i=await fetch(r);if(i.ok)return await i.json();throw t=await i.json(),new Error(t.error||"HTTP error! status: "+i.status)}catch(e){throw console.error("Error getting download status:",e),e}})(),i=(p.current.add(r),await r);p.current.delete(r),la.current&&(a="downloads"in i?i.downloads:[i],o(a),a.forEach(a=>{if(la.current){var r=ia.current[a.url],i=oa.current.has(a.url);if(!(r&&"Loading..."!==r.name&&"Failed to fetch metadata"!==r.name)&&!i){if(!r){if(!la.current)return;i=ia.current[a.url];i&&"Loading..."!==i.name&&"Failed to fetch metadata"!==i.name||(r=ca(da({},ia.current),{[a.url]:{name:"Loading...",uri:sa(a.url)||void 0}}),ia.current=r,ra(r))}let e=(async t=>{var N,W,j,H,q,M,G,Q,_,B,V,$,J,Y,K,Z,X,ee,te,ae,re,ie,oe,ne,le,se,de,ce,ue,pe,ge,ve,me,fe,ye,we,he,Se,be,xe,De,Ae,Ee,ke,Le,Te,Pe,Ce,Ie,Fe,Re,ze,Ue,Oe,Ne,We,je,He,qe,Me,Ge,Qe,_e,Be,Ve,$e,Je,Ye,Ke,Ze,Xe,et,tt,at,rt,it,ot,nt,lt,st,dt,ct,ut,pt,gt,vt,mt,ft,yt,wt;if(la.current){var o=sa(t);if(o){var a=ia.current[t];if(a&&"Loading..."!==a.name&&"Failed to fetch metadata"!==a.name)return a;if(oa.current.has(t))return a||null;if(la.current){oa.current.add(t),na(new Set(oa.current));var r,ht,St,n,bt,xt,Dt,At,a=o.split(":")[1],Et=o.split(":")[2];let i=null;try{try{if(Spicetify.CosmosAsync){let e=null;"track"===a?(e=await Spicetify.CosmosAsync.get("https://api.spotify.com/v1/tracks/"+Et))&&e.name&&!e.code&&!e.error&&(r=e.album,ht=(e.artists||[])[0],i={name:e.name||"Unknown Track",artist:(null==ht?void 0:ht.name)||"Unknown Artist",album:(null==r?void 0:r.name)||"Unknown Album",imageUrl:(null==(W=null==(N=null==r?void 0:r.images)?void 0:N[0])?void 0:W.url)||(null==(H=null==(j=null==r?void 0:r.images)?void 0:j[1])?void 0:H.url)||(null==(M=null==(q=null==r?void 0:r.images)?void 0:q[2])?void 0:M.url),uri:o,type:"track"}):"album"===a?(e=await Spicetify.CosmosAsync.get("https://api.spotify.com/v1/albums/"+Et))&&e.name&&!e.code&&!e.error&&(St=(e.artists||[])[0],i={name:e.name||"Unknown Album",artist:(null==St?void 0:St.name)||"Unknown Artist",album:e.name,imageUrl:(null==(Q=null==(G=e.images)?void 0:G[0])?void 0:Q.url)||(null==(B=null==(_=e.images)?void 0:_[1])?void 0:B.url)||(null==($=null==(V=e.images)?void 0:V[2])?void 0:$.url),uri:o,type:"album"}):"playlist"===a&&(e=await Spicetify.CosmosAsync.get("https://api.spotify.com/v1/playlists/"+Et))&&e.name&&!e.code&&!e.error&&(n=e.owner,i={name:e.name||"Unknown Playlist",artist:(null==n?void 0:n.display_name)||(null==n?void 0:n.name)||"Unknown Owner",album:e.name,imageUrl:(null==(Y=null==(J=e.images)?void 0:J[0])?void 0:Y.url)||(null==(Z=null==(K=e.images)?void 0:K[1])?void 0:Z.url)||(null==(ee=null==(X=e.images)?void 0:X[2])?void 0:ee.url),uri:o,type:"playlist"})}}catch(e){console.warn("CosmosAsync failed, trying GraphQL:",e)}if(!i)if("track"===a)try{var kt=null==(ae=null==(te=Spicetify.GraphQL)?void 0:te.Definitions)?void 0:ae.browseTrack;if(kt){var e=await Spicetify.GraphQL.Request(kt,{uri:o}),l=(null==e?void 0:e.trackUnion)||(null==e?void 0:e.track)||(null==(re=null==e?void 0:e.data)?void 0:re.trackUnion)||(null==(ie=null==e?void 0:e.data)?void 0:ie.track);if(l){var Lt,s,Tt,d,c,u=l.albumOfTrack||l.album,Pt=(null==(oe=l.artists)?void 0:oe.items)||l.artists,p=Array.isArray(Pt)?Pt[0]:Pt,Ct=(null==(ne=null==p?void 0:p.profile)?void 0:ne.name)||(null==p?void 0:p.name)||(null==p?void 0:p.displayName);let e;u&&((Lt=u.coverArt||u.cover)&&(s=Lt.sources||Lt.sourcesV2,e=(e=s&&Array.isArray(s)?(null==(le=s[2])?void 0:le.url)||(null==(se=s[0])?void 0:se.url)||(null==(de=s[1])?void 0:de.url):e)||(null==(ce=Lt.image)?void 0:ce.url)||Lt.url),e||(Tt=(null==(ue=u.images)?void 0:ue.items)||u.images)&&Array.isArray(Tt)&&0<Tt.length&&(c=(null==(d=Tt[0])?void 0:d.sources)||(null==d?void 0:d.sourcesV2),e=(e=c&&Array.isArray(c)?(null==(pe=c[2])?void 0:pe.url)||(null==(ge=c[0])?void 0:ge.url)||(null==(ve=c[1])?void 0:ve.url):e)||(null==d?void 0:d.url))),i={name:l.name||"Unknown Track",artist:Ct||"Unknown Artist",album:(null==u?void 0:u.name)||"Unknown Album",imageUrl:e,uri:o,type:"track"}}}else{let e=null,t=null,a=null,r=null;try{var g,It,Ft=null==(fe=null==(me=Spicetify.GraphQL)?void 0:me.Definitions)?void 0:fe.getTrackName;Ft&&(It=(null==(g=await Spicetify.GraphQL.Request(Ft,{uri:o}))?void 0:g.trackUnion)||(null==(ye=null==g?void 0:g.data)?void 0:ye.trackUnion)||(null==g?void 0:g.track)||(null==(we=null==g?void 0:g.data)?void 0:we.track))&&(e=It.name||It.title)}catch(e){}try{var v,m,Rt,f,y,zt,w,Ut,h,S,Ot=null==(Se=null==(he=Spicetify.GraphQL)?void 0:he.Definitions)?void 0:Se.queryTrackArtists;Ot&&(null!=(m=(null==(v=await Spicetify.GraphQL.Request(Ot,{uri:o}))?void 0:v.trackUnion)||(null==(be=null==v?void 0:v.data)?void 0:be.trackUnion)||(null==v?void 0:v.track)||(null==(xe=null==v?void 0:v.data)?void 0:xe.track))&&m.artists&&(Rt=m.artists.items||m.artists,f=Array.isArray(Rt)?Rt[0]:Rt,t=(null==(De=null==f?void 0:f.profile)?void 0:De.name)||(null==f?void 0:f.name)||(null==f?void 0:f.displayName)),null!=m&&m.albumOfTrack||null!=m&&m.album)&&(y=m.albumOfTrack||m.album,a=y.name,(zt=y.coverArt||y.cover)&&(w=zt.sources||zt.sourcesV2,r=(r=w&&Array.isArray(w)?(null==(Ae=w[2])?void 0:Ae.url)||(null==(Ee=w[0])?void 0:Ee.url)||(null==(ke=w[1])?void 0:ke.url):r)||(null==(Le=zt.image)?void 0:Le.url)||zt.url),r||(Ut=(null==(Te=y.images)?void 0:Te.items)||y.images)&&Array.isArray(Ut)&&0<Ut.length&&(S=(null==(h=Ut[0])?void 0:h.sources)||(null==h?void 0:h.sourcesV2),r=(r=S&&Array.isArray(S)?(null==(Pe=S[2])?void 0:Pe.url)||(null==(Ce=S[0])?void 0:Ce.url)||(null==(Ie=S[1])?void 0:Ie.url):r)||(null==h?void 0:h.url)))}catch(e){}if(!a)try{var b,Nt,Wt,x,jt=null==(Re=null==(Fe=Spicetify.GraphQL)?void 0:Fe.Definitions)?void 0:Re.getAlbumNameAndTracks;jt&&(b=await Spicetify.GraphQL.Request(jt,{uri:o}))&&!b.errors&&(Nt=(null==(ze=null==b?void 0:b.data)?void 0:ze.album)||(null==b?void 0:b.album))&&(a=Nt.name,Wt=(null==(Ue=Nt.images)?void 0:Ue.items)||Nt.images)&&Array.isArray(Wt)&&0<Wt.length&&(x=Wt[0],r=(null==(Ne=null==(Oe=null==x?void 0:x.sources)?void 0:Oe[2])?void 0:Ne.url)||(null==(je=null==(We=null==x?void 0:x.sources)?void 0:We[0])?void 0:je.url)||(null==x?void 0:x.url))}catch(e){}if(!a)try{var Ht,qt,Mt,D,Gt=null==(qe=null==(He=Spicetify.GraphQL)?void 0:He.Definitions)?void 0:qe.queryAlbumTracks;Gt&&(qt=(null==(Ht=await Spicetify.GraphQL.Request(Gt,{uri:o}))?void 0:Ht.album)||(null==(Me=null==Ht?void 0:Ht.data)?void 0:Me.album))&&(a=qt.name,Mt=(null==(Ge=qt.images)?void 0:Ge.items)||qt.images)&&Array.isArray(Mt)&&0<Mt.length&&(D=Mt[0],r=(null==(_e=null==(Qe=null==D?void 0:D.sources)?void 0:Qe[2])?void 0:_e.url)||(null==(Ve=null==(Be=null==D?void 0:D.sources)?void 0:Be[0])?void 0:Ve.url)||(null==D?void 0:D.url))}catch(e){}if(!a)try{var Qt,_t,A,Bt,Vt,E,$t=null==(Je=null==($e=Spicetify.GraphQL)?void 0:$e.Definitions)?void 0:Je.decorateContextTracks;$t&&(_t=(null==(Qt=await Spicetify.GraphQL.Request($t,{uris:[o]}))?void 0:Qt.tracks)||(null==(Ye=null==Qt?void 0:Qt.data)?void 0:Ye.tracks))&&Array.isArray(_t)&&0<_t.length&&(null!=(A=_t[0])&&A.albumOfTrack||null!=A&&A.album)&&(Bt=A.albumOfTrack||A.album,a=Bt.name,Vt=Bt.coverArt||Bt.cover)&&(E=Vt.sources||Vt.sourcesV2,r=(r=E&&Array.isArray(E)?(null==(Ke=E[2])?void 0:Ke.url)||(null==(Ze=E[0])?void 0:Ze.url)||(null==(Xe=E[1])?void 0:Xe.url):r)||(null==(et=Vt.image)?void 0:et.url)||Vt.url)}catch(e){}e&&(i={name:e,artist:t||"Unknown Artist",album:a||"Unknown Album",imageUrl:r,uri:o,type:"track"})}}catch(e){console.warn("GraphQL track fetch failed:",e)}else if("album"===a)try{var Jt=Spicetify.GraphQL.Definitions.browseAlbum;if(Jt){var k=await Spicetify.GraphQL.Request(Jt,{uri:o}),L=(null==k?void 0:k.albumUnion)||(null==k?void 0:k.album)||(null==(tt=null==k?void 0:k.data)?void 0:tt.albumUnion)||(null==(at=null==k?void 0:k.data)?void 0:at.album);if(L){var Yt=(null==(rt=L.artists)?void 0:rt.items)||L.artists,T=Array.isArray(Yt)?Yt[0]:Yt,Kt=(null==(it=null==T?void 0:T.profile)?void 0:it.name)||(null==T?void 0:T.name)||(null==T?void 0:T.displayName);let e;var P,Zt,C,I,Xt=L.coverArt||L.cover;Xt&&(P=Xt.sources||Xt.sourcesV2,e=(e=P&&Array.isArray(P)?(null==(ot=P[2])?void 0:ot.url)||(null==(nt=P[0])?void 0:nt.url)||(null==(lt=P[1])?void 0:lt.url):e)||(null==(st=Xt.image)?void 0:st.url)||Xt.url),e||(Zt=(null==(dt=L.images)?void 0:dt.items)||L.images)&&Array.isArray(Zt)&&0<Zt.length&&(I=(null==(C=Zt[0])?void 0:C.sources)||(null==C?void 0:C.sourcesV2),e=(e=I&&Array.isArray(I)?(null==(ct=I[2])?void 0:ct.url)||(null==(ut=I[0])?void 0:ut.url)||(null==(pt=I[1])?void 0:pt.url):e)||(null==C?void 0:C.url)),i={name:L.name||"Unknown Album",artist:Kt||"Unknown Artist",album:L.name,imageUrl:e,uri:o,type:"album"}}}}catch(e){console.warn("GraphQL album fetch failed:",e)}else if("playlist"===a)try{var ea=Spicetify.GraphQL.Definitions.browsePlaylist;if(ea){var F=await Spicetify.GraphQL.Request(ea,{uri:o}),R=(null==F?void 0:F.playlistV2)||(null==F?void 0:F.playlist)||(null==(gt=null==F?void 0:F.data)?void 0:gt.playlistV2)||(null==(vt=null==F?void 0:F.data)?void 0:vt.playlist);if(R){var z,U=R.owner,ta=(null==U?void 0:U.name)||(null==U?void 0:U.displayName)||(null==U?void 0:U.username),aa=(null==(mt=R.images)?void 0:mt.items)||R.images,O=Array.isArray(aa)?aa[0]:aa;let e;O&&(z=(null==O?void 0:O.sources)||(null==O?void 0:O.sourcesV2),e=(e=z&&Array.isArray(z)?(null==(ft=z[2])?void 0:ft.url)||(null==(yt=z[0])?void 0:yt.url)||(null==(wt=z[1])?void 0:wt.url):e)||(null==O?void 0:O.url)),i={name:R.name||"Unknown Playlist",artist:ta||"Unknown Owner",album:R.name,imageUrl:e,uri:o,type:"playlist"}}}}catch(e){console.warn("GraphQL playlist fetch failed:",e)}if(i||(xt=(bt=t.split("/"))[bt.length-1]||"Unknown",i={name:xt,artist:"Unknown",album:xt,imageUrl:void 0,uri:o,type:a}),i)return la.current?(Dt=ca(da({},ia.current),{[t]:i}),ia.current=Dt,ra(Dt),oa.current.delete(t),la.current&&na(new Set(oa.current)),i):null}catch(e){if(!la.current)return null;console.error("Error fetching metadata:",e),ia.current[t]&&"Loading..."!==ia.current[t].name&&"Failed to fetch metadata"!==ia.current[t].name||(At=ca(da({},ia.current),{[t]:{name:"Failed to fetch metadata",uri:o,type:a}}),ia.current=At,ra(At))}finally{oa.current.delete(t),la.current&&na(new Set(oa.current))}}}}return null})(a.url),t=(p.current.add(e),()=>{p.current.delete(e)});e.then(()=>{t()}).catch(e=>{t(),la.current&&console.error("Error fetching metadata:",e)})}}}),la.current)&&s(null)}}catch(e){la.current&&(s(e instanceof Error?e.message:b("ui.error")),console.error("Error fetching status:",e))}finally{la.current&&l(!1)}}},[]),f=(v.current=m,A(()=>{la.current=!0;var e=v.current,e=(e&&e(),setInterval(()=>{var e;la.current&&(e=v.current)&&e()},3e3));return g.current=e,()=>{la.current=!1,g.current&&(clearInterval(g.current),g.current=null),u.current&&(u.current.abort(),u.current=null),p.current.clear(),v.current=null}},[]),async e=>{try{var t=e;try{var a,r=await fetch(h()+"/cancel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})});if(!r.ok)throw a=await r.json(),new Error(a.error||"HTTP error! status: "+r.status)}catch(e){throw console.error("Error cancelling download:",e),e}await 0,await m(),Spicetify.showNotification(b("notifications.downloadCancelled"))}catch(e){Spicetify.showNotification(e instanceof Error?e.message:b("notifications.cancelFailed"),!0)}});var y=e.filter(e=>"all"===r||("active"===r?"downloading"===e.status||"starting"===e.status:"completed"===r?"completed"===e.status:"failed"===r?"failed"===e.status:"cancelled"!==r||"cancelled"===e.status)),w={total:e.length,active:e.filter(e=>"downloading"===e.status||"starting"===e.status).length,completed:e.filter(e=>"completed"===e.status).length,failed:e.filter(e=>"failed"===e.status).length,cancelled:e.filter(e=>"cancelled"===e.status).length};return t?x.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",color:"var(--spice-text-subdued)"}},b("ui.loading")):a?x.createElement("div",{style:{padding:"20px",color:"var(--spice-text-negative)"}},x.createElement("h2",null,b("ui.error")),x.createElement("p",null,a),x.createElement("button",{onClick:m,style:{marginTop:"10px",padding:"8px 16px",backgroundColor:"var(--spice-button)",color:"var(--spice-text)",border:"none",borderRadius:"4px",cursor:"pointer"}},b("ui.retry"))):x.createElement("div",{style:{padding:"24px",height:"100%",overflowY:"auto",backgroundColor:"var(--spice-main)"}},x.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px",flexWrap:"wrap",gap:"12px"}},x.createElement("div",null,x.createElement("h1",{style:{margin:0,fontSize:"24px",fontWeight:"bold"}},b("ui.title")),x.createElement("p",{style:{margin:"4px 0 0 0",fontSize:"14px",color:"var(--spice-text-subdued)"}},b("ui.downloads",{count:w.total}))),x.createElement("div",{style:{display:"flex",gap:"10px",alignItems:"center"}},x.createElement("button",{onClick:async()=>{try{try{var e,t=await fetch(h()+"/open-download-folder",{method:"POST",headers:{"Content-Type":"application/json"}});if(!t.ok)throw e=await t.json(),new Error(e.error||"HTTP error! status: "+t.status)}catch(e){throw console.error("Error opening download folder:",e),e}await 0,Spicetify.showNotification(b("notifications.folderOpened"))}catch(e){Spicetify.showNotification(e instanceof Error?e.message:b("notifications.openFolderFailed"),!0)}},style:{padding:"10px 20px",backgroundColor:"var(--spice-button)",color:"var(--spice-text)",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",transition:"opacity 0.2s"},onMouseEnter:e=>{e.currentTarget.style.opacity="0.8"},onMouseLeave:e=>{e.currentTarget.style.opacity="1"}},b("ui.openFolder")),x.createElement("button",{onClick:m,style:{padding:"10px 20px",backgroundColor:"var(--spice-button)",color:"var(--spice-text)",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",transition:"opacity 0.2s"},onMouseEnter:e=>{e.currentTarget.style.opacity="0.8"},onMouseLeave:e=>{e.currentTarget.style.opacity="1"}},b("ui.refresh")))),0<e.length&&x.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"12px",marginBottom:"24px"}},x.createElement("div",{style:{padding:"12px",backgroundColor:"var(--spice-card)",borderRadius:"8px",border:"1px solid var(--spice-border)"}},x.createElement("div",{style:{fontSize:"24px",fontWeight:"bold"}},w.total),x.createElement("div",{style:{fontSize:"12px",color:"var(--spice-text-subdued)"}},b("ui.total"))),x.createElement("div",{style:{padding:"12px",backgroundColor:"var(--spice-card)",borderRadius:"8px",border:"1px solid var(--spice-border)"}},x.createElement("div",{style:{fontSize:"24px",fontWeight:"bold",color:"var(--spice-text-bright-accent)"}},w.active),x.createElement("div",{style:{fontSize:"12px",color:"var(--spice-text-subdued)"}},b("ui.active"))),x.createElement("div",{style:{padding:"12px",backgroundColor:"var(--spice-card)",borderRadius:"8px",border:"1px solid var(--spice-border)"}},x.createElement("div",{style:{fontSize:"24px",fontWeight:"bold",color:"var(--spice-text-positive)"}},w.completed),x.createElement("div",{style:{fontSize:"12px",color:"var(--spice-text-subdued)"}},b("ui.completed"))),x.createElement("div",{style:{padding:"12px",backgroundColor:"var(--spice-card)",borderRadius:"8px",border:"1px solid var(--spice-border)"}},x.createElement("div",{style:{fontSize:"24px",fontWeight:"bold",color:"var(--spice-text-negative)"}},w.failed),x.createElement("div",{style:{fontSize:"12px",color:"var(--spice-text-subdued)"}},b("ui.failed"))),x.createElement("div",{style:{padding:"12px",backgroundColor:"var(--spice-card)",borderRadius:"8px",border:"1px solid var(--spice-border)"}},x.createElement("div",{style:{fontSize:"24px",fontWeight:"bold",color:"var(--spice-text-subdued)"}},w.cancelled),x.createElement("div",{style:{fontSize:"12px",color:"var(--spice-text-subdued)"}},b("ui.cancelled")))),0<e.length&&x.createElement("div",{style:{display:"flex",gap:"8px",marginBottom:"20px",flexWrap:"wrap"}},[{key:"all",label:b("ui.all")},{key:"active",label:b("ui.active")},{key:"completed",label:b("ui.completed")},{key:"failed",label:b("ui.failed")},{key:"cancelled",label:b("ui.cancelled")}].map(t=>x.createElement("button",{key:t.key,onClick:()=>i(t.key),style:{padding:"6px 14px",backgroundColor:r===t.key?"var(--spice-button)":"var(--spice-card)",color:"var(--spice-text)",border:"1px solid "+(r===t.key?"var(--spice-button)":"var(--spice-border)"),borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:r===t.key?"bold":"normal",transition:"all 0.2s"},onMouseEnter:e=>{r!==t.key&&(e.currentTarget.style.backgroundColor="var(--spice-card)",e.currentTarget.style.opacity="0.8")},onMouseLeave:e=>{r!==t.key&&(e.currentTarget.style.backgroundColor="var(--spice-card)",e.currentTarget.style.opacity="1")}},t.label))),0===y.length?x.createElement("div",{style:{textAlign:"center",padding:"60px 20px",color:"var(--spice-text-subdued)"}},x.createElement("div",{style:{fontSize:"48px",marginBottom:"16px"}},"ðŸ“¥"),x.createElement("div",{style:{fontSize:"16px",marginBottom:"8px"}},0===e.length?b("ui.noDownloads"):b("ui.noDownloadsFilter")),0===e.length&&x.createElement("div",{style:{fontSize:"14px"}},b("ui.startDownloading"))):x.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"12px"}},y.map(a=>{let e=ia.current[a.url]||n[a.url];var t=c.current[a.id],r=(null==e?void 0:e.imageUrl)||"https://placehold.co/120x120?text=No+Image",i=t||r,t=(null!=e&&e.imageUrl&&c.current[a.id]!==e.imageUrl?c.current[a.id]=e.imageUrl:t||(c.current[a.id]=r),e&&"Loading..."!==e.name&&"Failed to fetch metadata"!==e.name),r=t?e.name:(null==e||e.name,"Loading...");return x.createElement("div",{key:a.id,style:{display:"flex",gap:"16px",padding:"18px",backgroundColor:"var(--spice-card)",borderRadius:"10px",border:"1px solid var(--spice-border)",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 8px rgba(0, 0, 0, 0.15)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)"}},x.createElement("div",{style:{flexShrink:0,width:"120px",height:"120px",borderRadius:"8px",overflow:"hidden",backgroundColor:"var(--spice-border)",position:"relative"}},x.createElement("img",{key:`img-${a.id}-`+i,src:i,alt:(null==e?void 0:e.name)||"Cover",style:{width:"100%",height:"100%",objectFit:"cover"},onError:e=>{var t="https://placehold.co/120x120?text=No+Image";e.currentTarget.src!==t&&(c.current[a.id]=t,e.currentTarget.src=t)},onLoad:()=>{null!=e&&e.imageUrl&&c.current[a.id]!==e.imageUrl&&(c.current[a.id]=e.imageUrl)}}),"downloading"===a.status&&x.createElement("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"4px",backgroundColor:"rgba(0, 0, 0, 0.3)"}},x.createElement("div",{style:{width:a.progress+"%",height:"100%",backgroundColor:"var(--spice-text-bright-accent)",transition:"width 0.3s ease"}}))),x.createElement("div",{style:{flex:1,minWidth:0}},x.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"}},x.createElement("div",{style:{flex:1,minWidth:0}},x.createElement("div",{style:{fontSize:"16px",fontWeight:"bold",color:"var(--spice-text)",marginBottom:"6px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:r||a.url},r),(null==e?void 0:e.artist)&&x.createElement("div",{style:{fontSize:"14px",color:"var(--spice-text-subdued)",marginBottom:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},e.artist),(null==e?void 0:e.album)&&e.album!==e.name&&x.createElement("div",{style:{fontSize:"13px",color:"var(--spice-text-subdued)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},e.album),!e&&x.createElement("div",{style:{fontSize:"12px",color:"var(--spice-text-subdued)",marginTop:"4px",wordBreak:"break-all",fontFamily:"monospace"},title:a.url},50<a.url.length?a.url.substring(0,50)+"...":a.url),x.createElement("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"8px",marginBottom:"8px",flexWrap:"wrap"}},x.createElement("span",{style:(e=>{var t={display:"inline-flex",alignItems:"center",gap:"4px",padding:"4px 10px",borderRadius:"12px",fontSize:"12px",fontWeight:"bold"};switch(e){case"completed":return ca(da({},t),{backgroundColor:"rgba(30, 215, 96, 0.2)",color:"var(--spice-text-positive)"});case"failed":return ca(da({},t),{backgroundColor:"rgba(244, 33, 46, 0.2)",color:"var(--spice-text-negative)"});case"downloading":return ca(da({},t),{backgroundColor:"rgba(29, 185, 84, 0.2)",color:"var(--spice-text-bright-accent)"});case"starting":return ca(da({},t),{backgroundColor:"rgba(255, 255, 255, 0.1)",color:"var(--spice-text-base)"});case"cancelled":return ca(da({},t),{backgroundColor:"rgba(167, 167, 167, 0.2)",color:"var(--spice-text-subdued)"});default:return t}})(a.status)},x.createElement("span",null,(e=>{switch(e){case"completed":return"âœ“";case"failed":return"âœ—";case"downloading":return"â†“";case"starting":return"âŸ³";case"cancelled":return"âŠ˜";default:return"â€¢"}})(a.status)),x.createElement("span",null,(e=>{switch(e){case"starting":return b("ui.starting");case"downloading":return b("ui.downloading");case"completed":return b("ui.completedStatus");case"failed":return b("ui.failedStatus");case"cancelled":return b("ui.cancelledStatus");default:return e}})(a.status))),"downloading"===a.status&&x.createElement("span",{style:{color:"var(--spice-text-bright-accent)",fontSize:"14px",fontWeight:"bold"}},a.total_tracks&&void 0!==a.completed_tracks?a.progress+`% (${a.completed_tracks}/${a.total_tracks})`:a.progress+"%")),a.message&&x.createElement("div",{style:{fontSize:"13px",color:"var(--spice-text-subdued)",marginTop:"6px",fontStyle:"italic"}},a.message),a.error&&x.createElement("details",{style:{marginTop:"10px",fontSize:"12px"}},x.createElement("summary",{style:{color:"var(--spice-text-negative)",cursor:"pointer",fontWeight:"bold",marginBottom:"4px"}},b("ui.errorDetails")),x.createElement("div",{style:{padding:"10px",backgroundColor:"rgba(244, 33, 46, 0.1)",borderRadius:"6px",color:"var(--spice-text-negative)",marginTop:"4px",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",fontSize:"11px"}},a.error))),"downloading"===a.status&&x.createElement("button",{onClick:()=>f(a.id),style:{padding:"8px 16px",backgroundColor:"var(--spice-button)",color:"var(--spice-text)",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",whiteSpace:"nowrap",transition:"opacity 0.2s"},onMouseEnter:e=>{e.currentTarget.style.opacity="0.8"},onMouseLeave:e=>{e.currentTarget.style.opacity="1"}},b("ui.cancel"))),"downloading"===a.status&&x.createElement("div",{style:{width:"100%",height:"6px",backgroundColor:"var(--spice-border)",borderRadius:"3px",overflow:"hidden",marginTop:"14px",marginBottom:"8px"}},x.createElement("div",{style:{width:a.progress+"%",height:"100%",backgroundColor:"var(--spice-text-bright-accent)",transition:"width 0.3s ease",borderRadius:"3px"}})),x.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"11px",color:"var(--spice-text-subdued)",marginTop:"10px",paddingTop:"10px",borderTop:"1px solid var(--spice-border)"}},x.createElement("span",null,x.createElement("strong",null,b("ui.started"))," ",new Date(a.started_at).toLocaleString()),a.completed_at&&x.createElement("span",null,x.createElement("strong",null,b("ui.completedTime"))," ",new Date(a.completed_at).toLocaleString()))))})))},y=Spicetify.React,{useState:w,useEffect:L}=y,T=()=>{let[t,a]=w("5985"),[r,i]=w("127.0.0.1"),[e,o]=w(!1),[n,l]=w(null);L(()=>{var e=u();a(e.apiPort.toString()),i(e.apiHost)},[]);return y.createElement("div",{style:{padding:"20px",height:"100%",overflowY:"auto"}},y.createElement("h1",{style:{marginTop:0}},b("settings.title")),y.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"20px",maxWidth:"500px"}},y.createElement("div",null,y.createElement("label",{style:{display:"block",marginBottom:"8px",color:"var(--spice-text)",fontWeight:"bold"}},b("settings.apiHost")),y.createElement("input",{type:"text",value:r,onChange:e=>i(e.target.value),style:{width:"100%",padding:"8px",backgroundColor:"var(--spice-card)",color:"var(--spice-text)",border:"1px solid var(--spice-border)",borderRadius:"4px",fontSize:"14px"},placeholder:"127.0.0.1"})),y.createElement("div",null,y.createElement("label",{style:{display:"block",marginBottom:"8px",color:"var(--spice-text)",fontWeight:"bold"}},b("settings.apiPort")),y.createElement("input",{type:"number",value:t,onChange:e=>a(e.target.value),min:"1",max:"65535",style:{width:"100%",padding:"8px",backgroundColor:"var(--spice-card)",color:"var(--spice-text)",border:"1px solid var(--spice-border)",borderRadius:"4px",fontSize:"14px"},placeholder:"5985"})),n&&y.createElement("div",{style:{padding:"12px",backgroundColor:"var(--spice-notification-error)",color:"var(--spice-text-negative)",borderRadius:"4px",fontSize:"14px"}},n),e&&y.createElement("div",{style:{padding:"12px",backgroundColor:"var(--spice-notification-success)",color:"var(--spice-text-positive)",borderRadius:"4px",fontSize:"14px"}},b("notifications.settingsSaved")),y.createElement("div",{style:{display:"flex",gap:"10px"}},y.createElement("button",{onClick:()=>{try{var e=parseInt(t,10);isNaN(e)||e<1||65535<e?l(b("settings.portRange")):r&&""!==r.trim()?(p({apiPort:e,apiHost:r.trim()}),l(null),o(!0),setTimeout(()=>o(!1),2e3),Spicetify.showNotification(b("notifications.settingsSaved"))):l(b("settings.hostRequired"))}catch(e){l(e instanceof Error?e.message:b("settings.saveFailed"))}},style:{padding:"10px 20px",backgroundColor:"var(--spice-button)",color:"var(--spice-text)",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"}},b("settings.save")),y.createElement("button",{onClick:()=>{try{Spicetify.LocalStorage.remove(d)}catch(e){console.error("Error resetting config:",e)}var e=u();a(e.apiPort.toString()),i(e.apiHost),l(null),o(!1),Spicetify.showNotification(b("notifications.settingsReset"))},style:{padding:"10px 20px",backgroundColor:"var(--spice-card)",color:"var(--spice-text)",border:"1px solid var(--spice-border)",borderRadius:"4px",cursor:"pointer",fontSize:"14px"}},b("settings.reset"))),y.createElement("div",{style:{marginTop:"20px",padding:"16px",backgroundColor:"var(--spice-card)",borderRadius:"4px",border:"1px solid var(--spice-border)"}},y.createElement("h3",{style:{marginTop:0,marginBottom:"12px",fontSize:"16px",color:"var(--spice-text)"}},b("settings.apiServerSettings")),y.createElement("p",{style:{marginBottom:"12px",fontSize:"12px",color:"var(--spice-text-subdued)"}},b("settings.apiServerSettingsDesc")),y.createElement("button",{onClick:async()=>{try{try{var e,t=await fetch(h()+"/open-settings",{method:"POST",headers:{"Content-Type":"application/json"}});if(!t.ok)throw e=await t.json(),new Error(e.error||"HTTP error! status: "+t.status)}catch(e){throw console.error("Error opening settings:",e),e}await 0,Spicetify.showNotification(b("notifications.apiSettingsOpened"))}catch(e){console.error("Error opening API server settings:",e),Spicetify.showNotification(e instanceof Error?e.message:b("notifications.apiSettingsFailed"),!0)}},style:{padding:"10px 20px",backgroundColor:"var(--spice-button)",color:"var(--spice-text)",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",width:"100%"}},b("settings.openApiServerSettings")))))},{React:P,ReactDOM:C}=Spicetify;function I(e){e=e.split(":");return 3!==e.length||"spotify"!==e[0]?null:`https://open.spotify.com/${e[1]}/`+e[2]}var e=async function(){for(;null==Spicetify||!Spicetify.showNotification;)await new Promise(e=>setTimeout(e,100));var e=m(),t=e.detectLanguage(),a=u(),r=t||a.language||"en";e.setLanguage(r),t!==a.language&&p({language:t}),(e=await S())||Spicetify.showNotification(b("notifications.apiUnavailable"),!0),new Spicetify.ContextMenu.Item(b("menu.downloadTrack"),async e=>{for(var t of e)try{var a,r=I(t);r?(a=await g(r),Spicetify.showNotification(b("notifications.downloadStarted",{id:a.download_id}))):Spicetify.showNotification(b("notifications.invalidUri"),!0)}catch(e){console.error("Download error:",e),Spicetify.showNotification(e instanceof Error?e.message:b("notifications.downloadFailed"),!0)}},e=>e.some(e=>e.startsWith("spotify:track:")),"download").register(),new Spicetify.ContextMenu.Item(b("menu.downloadAlbum"),async e=>{for(var t of e)try{var a,r=I(t);r?(a=await g(r),Spicetify.showNotification(b("notifications.albumDownloadStarted",{id:a.download_id}))):Spicetify.showNotification(b("notifications.invalidUri"),!0)}catch(e){console.error("Download error:",e),Spicetify.showNotification(e instanceof Error?e.message:b("notifications.downloadFailed"),!0)}},e=>e.some(e=>e.startsWith("spotify:album:")),"download").register(),new Spicetify.ContextMenu.Item(b("menu.downloadPlaylist"),async e=>{for(var t of e)try{var a,r=I(t);r?(a=await g(r),Spicetify.showNotification(b("notifications.playlistDownloadStarted",{id:a.download_id}))):Spicetify.showNotification(b("notifications.invalidUri"),!0)}catch(e){console.error("Download error:",e),Spicetify.showNotification(e instanceof Error?e.message:b("notifications.downloadFailed"),!0)}},e=>e.some(e=>e.startsWith("spotify:playlist:")),"download").register(),new Spicetify.Menu.Item(b("menu.downloadStatus"),!1,()=>{{let t=document.createElement("div"),a=(t.style.width="100%",t.style.height="100%",C.render(P.createElement(f),t),Spicetify.PopupModal.display({title:b("ui.title"),content:t,isLarge:!0}),new MutationObserver(e=>{document.body.contains(t)||(C.unmountComponentAtNode(t),a.disconnect())})),e=(a.observe(document.body,{childList:!0,subtree:!0}),setInterval(()=>{document.body.contains(t)||(C.unmountComponentAtNode(t),a.disconnect(),clearInterval(e))},500));setTimeout(()=>{a.disconnect(),clearInterval(e)},3e5)}},"download").register(),new Spicetify.Menu.Item(b("menu.settings"),!1,()=>{var e;(e=document.createElement("div")).style.width="100%",e.style.height="100%",C.render(P.createElement(T),e),Spicetify.PopupModal.display({title:b("settings.title"),content:e,isLarge:!1})},"edit").register(),console.log("SpiceDL extension loaded successfully")};(async()=>{await e()})()})();